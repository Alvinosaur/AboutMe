<!DOCTYPE html>
<html lang="en">

<!-- Imports -->

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Personal Website">
  <meta name="author" content="Alvin Shek">

  <title>Learned Graph Structure for Learned Robot Dynamics</title>

  <!-- Bootstrap Core CSS -->
  <link href="../../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom Fonts -->
  <link href="../../vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic"
    rel="stylesheet" type="text/css">
  <link href="../../vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="../../css/project/wowchemy.min.css">
  <link rel="manifest" href="../../index.webmanifest">
  <link href="../../css/stylish-portfolio.css" rel="stylesheet">
  <link rel="icon" href="../../main_icon.svg">
  <link rel="apple-touch-icon" href="../../main_icon.svg">
  <link rel="canonical" href="https://github.com/SwapnilPande/v-cdn">
  <link rel="alternate" hreflang="en-us" href="https://github.com/SwapnilPande/v-cdn">

  <link rel="stylesheet" href="../../css/project/custom_project.css">

  <!-- Javascript -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

  <!------------------------------------------------------------------------>

  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <meta name="theme-color" content="hsl(267°, 95%, 76%)">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
    integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"
    integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css"
    crossorigin="anonymous" title="hl-light" disabled>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css"
    crossorigin="anonymous" title="hl-dark">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css"
    integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA=="
    crossorigin="anonymous">

  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">

</head>

<body id="page-top">

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
    <a class="navbar-brand js-scroll-trigger" href="#page-top">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="https://alvinosaur.github.io/AboutMe/#about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="https://alvinosaur.github.io/AboutMe/#projects">Projects</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger"
            href="https://alvinosaur.github.io/AboutMe/photography/main.html">Photography</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="https://alvinosaur.github.io/AboutMe/#contact_me">Contact Me</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="page-body bg-light">
    <article class="article article-project">

      <div class="article-container pt-3">
        <h1>Learned Graph Structure for Learned Robot Dynamics</h1>

        <div class="article-metadata">

          <span class="article-date">

            Dec 5, 2020
          </span>

        </div>

        <div class="btn-links mb-3">

          <a class="btn btn-outline-primary my-1 mr-1" href="final_report.pdf" target="_blank" rel="noopener">
            PDF
          </a>

          <a class="btn btn-outline-primary my-1 mr-1"
            href="https://github.com/SwapnilPande/v-cdn" target="_blank"
            rel="noopener">
            Code
          </a>

          <a class="btn btn-outline-primary my-1 mr-1"
            href="10708_poster.pdf"
            target="_blank" rel="noopener">
            Poster
          </a>

        </div>

      </div>

      <div class="article-header article-container featured-image-wrapper mt-4 mb-4"
        style="max-width: 720px; max-height: 369px;">
        <div style="position: relative">
          <img src="main.png" alt="" class="featured-image" id="main_pic">
          <span class="article-header-caption">Learned Graph Structure for Walker2D and Cheetah</span>
        </div>
      </div>

      <div class="article-container">

        <div class="article-style">
          <h3>Intro</h3>
          <p>
            Learned dynamics models have been extensively applied in planning and control for a wide variety of robotics tasks.
            These models are useful because they allow us to model environment state transition dynamics simply from a dataset
            of interactions, instead of manually programming a first-principles simulator, which can be very expensive and may
            not accurately capture the true environment dynamics. Recently, there has been growing interest in parametrizing
            dynamics models as graphical models, as this class of models naturally capture the dependencies in the behavior
            of complex mechanical systems. The inductive biases that these graphical models provide have the potential to
            reduce model size and improve generalization performance over the standard multi-layer perceptron. However, most
            implementations have assumed that the graphical structure of the mechanical system is known a priori. While this
            may be a safe assumption for very simple systems, this assumption does not hold for complex systems with many
            links and actuators. Furthermore, it is possible that even for simple systems, a structure that captures all of the
            relationships may not be evident a priori. For example, for a legged robot, we could na ̈ıvely describe links as nodes,
            and add edges for every joint. However, we may find that due to the nature of the gaits that we could also add edges
            between opposite legs, due to the dependencies imposed by the gait. Therefore, we aim to address the challenge of
            learning the graph structure of a given dynamical system for the inference of the system’s dynamics
          </p>

        </div>

        <h3>Model Architecture</h3>
        <div class="article-header article-container featured-image-wrapper mt-4 mb-4"
          style="max-width: 720px; max-height: 369px;">
          <div style="position: relative">
            <img src="model_arch.png" alt="" class="featured-image">
            <span class="article-header-caption">Model Architecture</span>
          </div>
        </div>
        <br>
        <p>
          The above picture shows our full architecture. 
          <ul>
            <li>
              (a) Learning architecture: Using observed trajectories the causal summary graph is inferred using the Inference
              module. The dynamics of the system is simultaneously learned using the Dynamics module that operates on the identified
              graph. 
            </li>
            <li>
              (b) Inference module discovers the edge set and the associated parameters. First, we propagate information spatially
              at each time step using a graph network which inputs a fully connected graph over all nodes. The output node and edge
              embeddings are then aggregated temporally and fed into a 1D-CNN to output temporal aggregations which are again be passed
              though another graph network that predicts a discrete distribution over edge types. Sampling from this distribution using the
              Gumbel-Softmax technique and passing through another graph network then gives the continuous edge parameters. The edge
              types and edge parameters together constitute the causal graph. 
            </li>
            <li>
              (c) Dynamics module: The left half of this subplot shows the
              graph network building block which acts as a single message passing step. The encoder encodes the node and edge parameters
              and observations and feeds them to the processor which acts like a sequence of message passing steps with skip connections.
              The output is then passed through the decoder which predicts the next state.
            </li>
          </ul>
          
        </p>

        <h3>Qualitative Results</h3>
        The <a href="#main_pic">figure at the top of the page</a> visualizes the learned edges (directed arrows) and a priori known nodes (circles) annotated on top of the
        simulation models. 
        <ul>
          <li>
            (a) shows the output of our CDN-EPD model, which resembles an almost fully-connected
            graph. This shows that the model was not able to identify the most meaningful edges, explaining the poor prediction
            performance. 
          </li>
          <li>
            (b) shows the output of CDN-GN, which is more sparse with dense connections only
            between nodes on the same leg. This matches our intuition since joints that are physically connected or spatially nearby
            should have edges. Only a few edges are learned across the two legs, and this possibly represents the relationship
            between the two legs in a gallop or walking motion since the legs follow a cyclic motion pattern. This shows the
            promise of learning a graph to discover useful relationships rather than assuming fixed priors. 
          </li>
          <li>
            (c) and (d) show similar trends.
          </li>
        </ul>
        
        <h3>Quantitative Results</h3>
        <div class="article-header article-container featured-image-wrapper mt-4 mb-4"
          style="max-width: 720px; max-height: 500px;">
          <div style="position: relative">
            <img src="results.png" alt="" class="featured-image">
            <span class="article-header-caption">Quantitative Results</span>
          </div>
        </div>
        <p>
          In all experiments, we find that the performance of the EPD dynamics model is
          worse than that of the GN model. We hypothesize that this is a result of the additional
          hyperparameters that the EPD model introduced, which may not be tuned correctly.
          Specifically, we believe that varying the number of message passing steps EPD performs
          (currently performing 10), may have a significant influence on performance, as GN per-
          forms better with a single step. Additionally,
          the added complexity of the model may be
          causing the joint optimization between the
          graph inference network and the dynamics
          prediction to settle into a local minimum, resulting in the mostly fully-connected graphs
          we see in the top figures (c) and (d). A potential fix for
          avoiding local optima could be pretraining
          the dynamics model based on a heuristic a
          priori graph.
        </p>
        <br>

        <div class="media author-card content-widget-hr">


          <a href="https://alvinosaur.github.io/AboutMe"><img class="avatar mr-3 avatar-circle"
              src="../../profile_pic.jpg" alt="Alvin Shek"></a>


          <div class="media-body">
            <h5 class="card-title"><a href="https://alvinosaur.github.io/AboutMe">Alvin Shek</a></h5>
            <h6 class="card-subtitle">Robotics Masters Student @ CMU</h6>
            <p class="card-text">Robotics, Computer Vision, Deep Learning, Reinforcement Learning.</p>
            <ul class="network-icon" aria-hidden="true">

              <li>
                <a href="mailto:ashek@andrew.cmu.edu">
                  <i class="fas fa-envelope"></i>
                </a>
              </li>

              <li>
                <a href="https://github.com/Alvinosaur" target="_blank" rel="noopener">
                  <i class="fab fa-github"></i>
                </a>
              </li>

              <li>
                <a href="https://www.linkedin.com/in/alvinshek/" target="_blank" rel="noopener">
                  <i class="fab fa-linkedin"></i>
                </a>
              </li>

              <li>
                <a href="../../Alvin_Shek_Resume.pdf" target="_blank" rel="noopener">
                  <i class="far fa-address-book"></i>
                </a>
              </li>

            </ul>

          </div>
        </div>


        <div class="project-related-pages content-widget-hr">

        </div>
      </div>
    </article>
  </div>


</body>

</html>