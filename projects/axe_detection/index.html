<!DOCTYPE html>
<html lang="en">

<!-- Imports -->

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Personal Website">
  <meta name="author" content="Alvin Shek">

  <title>Automated Scoring for Axe Throwing</title>

  <!-- Bootstrap Core CSS -->
  <link href="../../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom Fonts -->
  <link href="../../vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic"
    rel="stylesheet" type="text/css">
  <link href="../../vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="../../css/project/wowchemy.min.css">
  <link rel="manifest" href="../../index.webmanifest">
  <link href="../../css/stylish-portfolio.css" rel="stylesheet">
  <link rel="icon" href="../../main_icon.svg">
  <link rel="apple-touch-icon" href="../../main_icon.svg">
  <link rel="canonical" href="https://alvinosaur.github.io/AboutMe/projects/axe_detection">
  <link rel="alternate" hreflang="en-us" href="https://alvinosaur.github.io/AboutMe/projects/axe_detection">

  <link rel="stylesheet" href="../../css/project/custom_project.css">

  <!-- Javascript -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

  <!------------------------------------------------------------------------>

  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <meta name="theme-color" content="hsl(267Â°, 95%, 76%)">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
    integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"
    integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css"
    crossorigin="anonymous" title="hl-light" disabled>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css"
    crossorigin="anonymous" title="hl-dark">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css"
    integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA=="
    crossorigin="anonymous">

  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">

</head>



<body id="page-top">

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
    <a class="navbar-brand js-scroll-trigger" href="#page-top">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="https://alvinosaur.github.io/AboutMe/#about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="https://alvinosaur.github.io/AboutMe/#projects">Projects</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger"
            href="https://alvinosaur.github.io/AboutMe/photography/main.html">Photography</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="https://alvinosaur.github.io/AboutMe/#contact_me">Contact Me</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="page-body bg-light">
    <article class="article article-project">

      <div class="article-container pt-3">
        <h1>Automated Scoring for Axe Throwing</h1>

        <div class="article-metadata">

          <span class="article-date">

            Dec 29, 2019
          </span>

        </div>

        <div class="btn-links mb-3">

          <a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/Alvinosaur/Axe_Tracker" target="_blank"
            rel="noopener">
            README + Code
          </a>

          <a class="btn btn-outline-primary my-1 mr-1"
            href="https://docs.google.com/presentation/d/1uH9LAQfr25p53zjWGmO-NtlNtRkCWy8wm5Qc7UlbyAk/edit?usp=sharing"
            target="_blank" rel="noopener">
            Slides
          </a>

          <a class="btn btn-outline-primary my-1 mr-1"
            href="https://drive.google.com/drive/folders/1i-IyCfMGqFx7QGnfqr1J7kUjCxeZ2bJV?usp=sharing" target="_blank"
            rel="noopener">
            Dataset + Google Colab
          </a>

        </div>

      </div>

      <div class="article-header article-container featured-image-wrapper mt-4 mb-4"
        style="max-width: 720px; max-height: 369px;">
        <div style="position: relative">
          <img src="main.jpg" alt="" class="featured-image">
          <!-- <span class="article-header-caption"></span> -->
        </div>
      </div>

      <div class="article-container">

        <div class="article-style">

          <h3>Summary</h3>

          <p>
            I helped the Lumberjaxes axe-throwing company in Pittsburgh, PA
            develop an automated scoring system for axe throws with mentorship
            from Dr. George Kantor. In axe throwing, there are three rings that
            make up a bullseye, and the deepest ring that an axe lies in
            determines the score. Working from inside to outer ring, scores are
            5, 3, 1, and 0 where 0 score is given if the axe does not lie in any
            ring. Having an automated scoring system for a static
            bullseye is not useful since people will need to pry their axe off
            a target and can calculate the score while doing so with no extra effort. However,
            this project is a foundation for more interesting games with moving
            targets and multiple throws where score-keeping would grow complicated.
          </p>

          <h3>Data Collection + Detection</h3>
          <p>
            My first step was to implement axe detection (not scoring)
            and set up a system to take a picture whenever an axe appears on the
            target. This serves the dual purpose of collecting images for the
            dataset as well as detecting on the real system. Axe detection
            was accomplished by using the SSIM algorithm, which essentially
            <a href="https://docs.google.com/presentation/d/1Z8DYN7VcDcc7ToR8XDTzJtpuj3n0Rf8O7oLZPMprWzc/edit#slide=id.g6ff5876fa8_0_116"
              target="_blank" rel="noopener">compares two different images based
              on luminance, contrast, and
              structure.</a> Then, if similarity is within some bound (different enough
            to not be identical images, but similar enough to not be caused by
            a person moving into view), the image is saved. With all these
            images, I manually parsed through all the positives and negatives
            and hand-labeled the bounding box of the axe tip for every positive
            image. This makes up the axe dataset. Future work could include
            negative hard mining, a CNN-based axe detector, and the inclusion of edge-case images where the
            axe is still visible, but part of the image is occluded by a person:
          </p>
          <img src="edge_case.jpg" alt="" class="featured-image" style="width:300px">

          <h3>Ring Detection</h3>
          <p>
            The next component is ring detection, which involves classical
            copmuter vision. Each ring has a distinct color, so I tuned basic
            RGB color filters to isolate pixels of each ring. Since filtering
            isn't perfect, I then implemented RANSAC to extract the best fit
            circle for each ring. As long as one ring is detected, the other
            rings can be approximated using hard-coded offsets for radii,
            which works since our camera is assumed to a fixed distance from the
            target.
            <a href="https://github.com/Alvinosaur/Axe_Tracker/tree/master/scripts_rpi/helpers" target="_blank"
              rel="noopener">Relevant code can be found in this directory.</a>
          </p>

          <h3>Axe Scoring</h3>
          <p>
            I tried multiple methods for axe tip detection (Blob detection + PCA, Fully Connected
            Network (FCN)) before finalizing on MaskRCNN, a pixel-level segmentation
            CNN. The Blob detection would often fail due to shadows and noise in
            the image, while precisely detecting the axe tip location with PCA
            did not work. The FCN was a naive modification of a previous
            homework assignment since I had no in-depth knowledge of Deep
            Learning at the time. MaskRCNN served well to handle the
            complexities in lighting, shadows, and size of the axes.
          </p>

          <h3>Results</h3>
          <img src="results_comparison.jpg" alt="" class="featured-image">
          <p>
            The above figure compares performance between (top) MaskRCNN and (bottom) classical Blob
            Detection + PCA. A confusion matrix plots true scores vs predicted
            scores from the model/algorithm. Ideally, all counts or probability
            should lie on the diagonal from top left to bottom right. This means
            the true score matches the predicted score. The left plot is simply
            the normalized version of the right plot, showing percentages
            instead of counts, where each row should sum to 1. As a
            refresher, here are the definitions of
            precision and recall:
          </p>

          <ul>
            <li>Precision = True Positives / Predicted Positives</li>
            <li>Recall = True Positives / Actual Positives</li>
          </ul>

          <p>
            The above only has mentioned software. For hardware, I used a
            Raspberry Pi 4 Model B since this is the only model that supports
            Tensorflow for MaskRCNN. Average runtime for axe detection was 1.2s,
            while axe scoring was 11s. This long runtime for scoring is
            unacceptable since we want scoring done in a matter of 2 to 3
            seconds, but is left as future work. <a
              href="https://docs.google.com/document/d/14kVA9lhM9vlDu0PzWhGbjlJfr_60oSK5k4-yUz0RZ6I/edit?usp=sharing"
              target="_blank" rel="noopener">Choice of macro lens and camera
              can be found here.</a>

          </p>

          <h3>Mechanical Design</h3>
          <p>
            I designed a custom mount system with adjustable angles for the
            camera. The below pictures show different angles of the final design
            and orientation of the camera with respect to the bullseye target. <a
              href="https://docs.google.com/presentation/d/1XZY_rIJcyj0cT6RWiLMSZJaU2oba6PDZcBjUC_9ZC8g/edit?usp=sharing"
              target="_blank" rel="noopener">More pictures can be found here.
            </a>
            Please contact Dr. George Kantor for access to the CAD files.
          </p>
          <img src="mech_design_1.jpg" alt="" class="featured-image">
          The red lines above represent a rubber band that create tension force and
          lock the teeth into place.
          <img src="mech_design_2.jpg" alt="" class="featured-image">
          <img src="mech_design_3.jpg" alt="" class="featured-image">



          <div class="media author-card content-widget-hr">


            <a href="https://alvinosaur.github.io/AboutMe"><img class="avatar mr-3 avatar-circle"
                src="../../profile_pic.jpg" alt="Alvin Shek"></a>


            <div class="media-body">
              <h5 class="card-title"><a href="https://alvinosaur.github.io/AboutMe">Alvin Shek</a></h5>
              <h6 class="card-subtitle">Robotics Masters Student @ CMU</h6>
              <p class="card-text">Robotics, Computer Vision, Deep Learning, Reinforcement Learning.</p>
              <ul class="network-icon" aria-hidden="true">

                <li>
                  <a href="mailto:ashek@andrew.cmu.edu">
                    <i class="fas fa-envelope"></i>
                  </a>
                </li>

                <li>
                  <a href="https://github.com/Alvinosaur" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i>
                  </a>
                </li>

                <li>
                  <a href="https://www.linkedin.com/in/alvinshek/" target="_blank" rel="noopener">
                    <i class="fab fa-linkedin"></i>
                  </a>
                </li>

                <li>
                  <a href="../../Alvin_Shek_Resume.pdf" target="_blank" rel="noopener">
                    <i class="far fa-address-book"></i>
                  </a>
                </li>

              </ul>

            </div>
          </div>


          <div class="project-related-pages content-widget-hr">

          </div>
        </div>
    </article>
  </div>


</body>

</html>